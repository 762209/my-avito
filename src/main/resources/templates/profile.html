<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<title>Insert title here</title>
	</head>
	<body>
		<div th:if="${currUser != null}">
			<h2 th:text="${currUser.fullname}"></h2>
			<form method="POST" th:action="@{/logout}">
				<input type="submit" value="Logout"/>
			</form>
		</div>
		
		<h1>Choose ad type</h1>
			<form th:method="GET" th:action="@{/profile}" th:object="${search}">
				<select name="category" th:field="*{adCategory}">
					<option th:value='NULL'>Выберите категорию</option>
					<option th:value='NULL' disabled>ТРАНСПОРТ</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).CAR}" >Автомобили</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).MOTORCYCLE}">Мотоциклы</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).TRUCK_AND_SPECIAL_MACHINERY}">Грузовики и спецтехника</option>
					<option th:value='NULL' disabled>НЕДВИЖИМОСТЬ</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).APARTMENTS}">Квартиры</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).HOUSES}">Дома</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).GARAGE}">Гаражи</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).SERVICE}">УСЛУГИ</option>
					<option th:value="${T(avito.domain.Ad$AdCategory).ANIMAL}">ЖИВОТНЫЕ</option>
				</select>
				
				<input type="text" th:field="*{name}" placeholder="Название" />
				<input type="text" th:field="*{city}" placeholder="Город" />
				<input type="submit" value="Выбрать" />
			</form>
		<div th:each="ad : ${page}">
			<img th:if="${ad.getPhotos.size() > 0}"
				 th:src="'data:image/png;base64,'+${imgUtil.getImgData(ad.getPhotos.get(0).getPhoto())}" 
				 width=50px height=50px/> </br>
			<img th:if="${ad.getPhotos.size() == 0}"
				 th:src="@{/images/no_image.png}"
				 width=50px height=50px/> </br>
			<span th:text="${ad.name}" /> </br>
			<span th:text="${ad.description}" /> </br>
			<span th:text="${ad.price}" /> </br>
			<span th:text="${#temporals.format(ad.createdAt,'dd-MM-yyyy HH:mm')}" /> </br>
			<a th:href="@{'/home/show/' + ${ad.id}}">Открыть объявление</a> </br>
			<form th:method="delete" th:action="@{/profile/delete/{id}(id=${ad.getId()})}">
				<input type="submit" value="Удалить" />
			</form>
		</div>
		<div>
			Всего объявлений: [[${page.totalElements}]] - Cтраницa [[${page.number + 1}]] из [[${page.totalPages < 1 ? 1 : page.totalPages}]] 
			&nbsp; - &nbsp;
			<a th:if="${page.number + 1 > 1}" th:href="@{/home/page/1}">Начало</a>
			<span th:unless="${page.number + 1 > 1}">Начало</span>
			&nbsp;
			<a th:if="${page.number + 1 > 1}" th:href="@{'/home/page/' + ${page.number + 1 - 1}}">Предыдущая</a>
			<span th:unless="${page.number + 1 > 1}">Предыдущая</span>
			&nbsp;
			<span th:each="i : ${#numbers.sequence(page.number + 1 > 2 ? page.number + 1 - 2 : 1,
 												   page.totalPages < 1 ? 1 : page.totalPages > 2 + page.number + 1 ? page.number + 1 + 2 : page.totalPages)}">
				<span>
					<a th:if="${i != page.number + 1}" th:href="@{'/home/page/' + ${i}}">[[${i}]]</a>
					<span th:unless="${i != page.number + 1}">[[${i}]]</span>
					&nbsp;
				</span>
			</span>
			<a th:if="${page.number + 1 < page.totalPages}" th:href="@{'/home/page/' + ${page.number + 1 + 1}}">Следующая</a>
			<span th:unless="${page.number + 1 < page.totalPages}">Следующая</span>
			&nbsp;
			<a th:if="${page.number + 1 < page.totalPages}" th:href="@{'/home/page/' + ${page.totalPages}}">Конец</a>
			<span th:unless="${page.number + 1 < page.totalPages}">Конец</span>
		</div>
	</body>
</html>